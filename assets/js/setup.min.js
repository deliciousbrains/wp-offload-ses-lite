!function(n){function r(e,o){n.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:{_nonce:wposes.nonces.ajax_save_settings,action:"wposes-ajax-save-settings",settings:e},error:function(e,s,t){alert("error"+t)},success:function(e,s,t){void 0!==e.data.verified_senders&&(wposes.verified_senders=e.data.verified_senders),"settings"===o?window.location=wposes.plugin_url+"&setup-complete=true#settings":(n("#setting-error-settings_updated").remove(),window.location.hash=o)}})}n("#tab-setup-access-keys .wposes-wizard-next-btn").on("click",function(e){e.preventDefault();var o=n("#wposes-setup-region").serialize(),s=n('select[name="region"] option:selected').text();n(".wposes-region").text(s);var t=new wposes.AccessKeys,a=n('input[name="aws-access-key-id"]'),i=n('input[name="aws-secret-access-key"]');a.is(":disabled")&&i.is(":disabled")?r(o,"sandbox-mode"):n.when(t.sendRequest("set",{"aws-access-key-id":a.val(),"aws-secret-access-key":i.val()})).then(function(e,s,t){e.success?(i.val(wposes.strings.not_shown_placeholder),r(o,"sandbox-mode")):void 0!==e.data.access_keys_defined&&!0===e.data.access_keys_defined?r(o,"sandbox-mode"):n("#wposes_access_keys").show()})}),n('.wposes-sender-type-toggle input[type="radio"]').on("change",function(){"wposes-email"===this.id?(n(".wposes-show-domain").hide(),n(".wposes-show-email").show()):(n(".wposes-show-email").hide(),n(".wposes-show-domain").show())}),n("#tab-verify-sender .wposes-wizard-next-btn").on("click",function(e){e.preventDefault();var s=n('input[name="sender-type"]:checked').val(),t=n("#wposes-setup-verify-domain");if("email"===s&&(t=n("#wposes-setup-verify-email")),t[0].checkValidity()){var o,a,i=t.val();o=i,a=s,n.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:{_nonce:wposes.nonces.wposes_verify_sender,action:"wposes-verify-sender",sender:o,sender_type:a},error:function(e,s,t){alert("error"+t)},success:function(e,s,t){void 0===e.errors?(wposes.verified_senders.push(o),"domain"===a&&n(".wposes-domain-dns").html("<tr><th>Type</th><th>Name</th><th>Value</th><tr><td>TXT</td><td><code data-wposes-copy>_amazonses."+o+"</code></td><td><code data-wposes-copy>"+e.VerificationToken+"</code></td></tr>"),n(".wposes-sender").html(o),window.location.hash="complete-verification"):n(".wposes-verification-errors").show()}})}else t[0].reportValidity()}),n("#tab-configure-wp-offload-ses .wposes-wizard-next-btn").on("click",function(e){e.preventDefault();var s=n('input[name="default-email"]');if(s[0].setCustomValidity(""),!wposes.isVerifiedIdentity(s.val()))return s[0].setCustomValidity(wposes.strings.email_not_verified),void s[0].reportValidity();r(n("#wposes-setup-final-settings").serialize(),"settings")}),n(document).on("wposes.tabRendered",function(){-1<["start","create-iam-user","access-keys","sandbox-mode","verify-senders","complete-verification","configure-wp-offload-ses"].indexOf(location.hash.substring(1))&&n(".nav-tab.start").attr("href",location.hash).addClass("nav-tab-active"),n(".wposes-verification-errors").hide()})}(jQuery);